---
sidebar: sidebar 
permalink: task_install_manual_au.html 
keywords: Acquisition Unit, AU, install, configure, Linux, add, remove, uninstall, delete, deleting, move, moving, manual, AU, Patch 
summary: Data Infrastructure Insights kann so konfiguriert werden, dass die AU-Software manuell aktualisiert wird, wodurch Sie mehr Kontrolle über die auf Ihrem Mandanten installierte Software haben. 
---
= Manuelles Installieren der Software der Erfassungseinheit
:hardbreaks:
:allow-uri-read: 


[role="lead"]
Standardmäßig aktualisiert Data Infrastructure Insights die Acquisition Unit (AU)-Software automatisch, wenn Updates bereitgestellt werden.  In sicheren, kontrollierten Umgebungen ist eine automatische Aktualisierung jedoch möglicherweise nicht möglich oder erwünscht.  In diesen Fällen kann Data Infrastructure Insights so konfiguriert werden, dass die AU-Software manuell aktualisiert wird, was Ihnen mehr Kontrolle über die auf Ihrem Mandanten installierte Software bietet.

Führen Sie die folgenden Schritte aus, um die AU-Software manuell herunterzuladen und zu installieren.  Data Infrastructure Insights bietet eine hilfreiche Swagger-Dokumentationsseite, die Sie für viele dieser Schritte verwenden können, oder Sie können Ihr eigenes API-Skript/Ihre eigenen API-Befehle verwenden.  Gehen Sie zu Admin > API-Zugriff und klicken Sie auf den Link „API-Dokumentation“.

Der Vorgang ist für Linux und Windows ähnlich.



== Durchführen einer NEUEN AU-Installation unter Linux:

. Erstellen Sie in Data Infrastructure Insights ein API-Token.
+
.. Navigieren Sie zu *Admin > API-Zugriff* und wählen Sie *+API-Zugriffstoken*.
+
... Legen Sie einen *Namen* und eine *Beschreibung* fest, die leicht zu identifizieren sind
... Typ: Wählen Sie *Erfassungseinheit* und *Datenerfassung*
... Berechtigungen: *Lesen/Schreiben*
... Wählen Sie die gewünschten Werte für *Ablauf* und *Automatische Verlängerung*


.. Klicken Sie auf *Speichern*
.. Kopieren Sie das generierte API-Zugriffstoken.  Dieser Schritt muss ausgeführt werden, bevor Sie das Fenster schließen können.




image:Manual_AU_Create_API_Token.png["API-Token erstellen"]

. Verwenden Sie in Swagger (Admin > API-Zugriff > API-Dokumentation) das Token, um Data Infrastructure Insights -APIs zu autorisieren
+
.. Klicken Sie oben rechts im Swagger-Bildschirm auf _Autorisieren_
.. Fügen Sie das oben kopierte Token in das Feld „Customer APIKey“ ein
.. Klicken Sie auf *Autorisieren*
.. Schließen Sie das Fenster




image:Manual_AU_Authorization.png["Autorisieren des API-Tokens"]

. Laden Sie das AU-Installationsprogramm mithilfe der API _/au/installers/{platform}/latest_ oder _/au/installers/{platform}/{version}_ herunter:
+
.. Plattform: *Linux*
.. Version: *<Version>* (neueste oder angegebene)




image:Manual_AU_API_Retrieve_latest.png["API zum Abrufen der neuesten AU-Version"]


NOTE: Wenn Sie nicht die neueste Version herunterladen, bestätigen Sie mit NetApp die AU-Version, die zum Download angegeben werden soll.

. Klicken Sie auf *Datei herunterladen*.  Wenn Sie diese Schritte auf einem anderen System als dem AU-System ausführen, kopieren Sie die heruntergeladene Datei auf das AU-System.
. Alternativ können Sie den resultierenden CURL-Befehl auf dem AU-System ausführen:
+
 curl -X GET "<tenant>/rest/v1/au/installers/linux/<AU version>" -H "accept: application/octet-stream" -H "X-CloudInsights-ApiKey: <token>"
. Zu diesem Zeitpunkt sollte die Installationsdatei auf dem AU-System vorhanden sein.



IMPORTANT: Die nächsten Schritte erfordern die Verwendung eines temporären Tokens.  Verwenden Sie nicht das oben erstellte API-Zugriffstoken.

. Erstellen Sie im Data Infrastructure Insights API Swagger mithilfe der API _/au/oneTimeToken_ ein Einmaltoken.
+
.. Kopieren Sie das resultierende Einmaltoken.




image:Manual_AU_one_time_token.png["Einmalig verwendbares API-Token erstellen"] image:Manual_AU_one_time_token_response.png["Antwort für das Beispiel eines API-Tokens zur einmaligen Verwendung"]

. Navigieren Sie auf dem Computer, auf dem die AU installiert werden soll, zu dem Ordner, der die heruntergeladene Installationsdatei enthält.  Für die folgenden Befehle muss der Benutzer über Root-Berechtigungen verfügen.
+
.. Entpacken Sie die Installationsdatei
.. Wechseln Sie in das Verzeichnis des resultierenden Installationsordners
.. Exportieren Sie das Einmaltoken und die Installationsversion in Umgebungsvariablen, indem Sie Folgendes ausführen:
+
 export TOKEN=<One-Time Token>
.. Führen Sie Folgendes aus, um CI mit einem benutzerdefinierten Benutzer und einer benutzerdefinierten Gruppe zu installieren:
+
 ./cloudinsights-install.sh <custom user> <custom group>
+
Hinweis: Wenn Sie keinen benutzerdefinierten Benutzer und keine benutzerdefinierte Gruppe verwenden möchten, können Sie den Standardbenutzer und die Standardgruppe „cisys“ verwenden.  Führen Sie in diesem Fall den obigen Installationsbefehl aus, geben Sie jedoch weder Benutzer noch Gruppe an.





Zu diesem Zeitpunkt ist die AU-Software auf dem System installiert und für den benutzerdefinierten Benutzer und die Gruppe zugänglich.  Sie haben jedoch nicht die Möglichkeit, Datensammler hinzuzufügen.  Um dies manuell durchzuführen, lesen Sie die folgenden Anweisungen.  Wenn Sie nur einen Patch installieren möchten, lesen Sie die<<downloading-a-patch,Patch>> Abschnitt unten.



== Manuelles Installieren von Datenkollektoren

Laden Sie die neueste Datei datasources.war mithilfe der API /collector/patch/datasourceswar/latest herunter:

image:API_Manual_Download_datasources.png["API zum Abrufen der neuesten datasources.war"]

Hinweis: Wenn Sie nicht die neueste Version herunterladen, bestätigen Sie mit NetApp die Version, die zum Download angegeben werden soll.

Klicken Sie auf Datei herunterladen.  Wenn Sie diese Schritte auf einem anderen System als dem AU-System ausführen, kopieren Sie das heruntergeladene ZIP-Paket „datasources.war“ auf das AU-System.

Stellen Sie sicher, dass das ZIP-Paket „datasources.war“ in das folgende Verzeichnis kopiert wird: /var/lib/netapp/cloudinsights/acq/download

Navigieren Sie zum Verzeichnis /var/lib/netapp/cloudinsights/acq/download für datasources.war und überprüfen Sie dort die ZIP-Datei:

. Für die nächsten Schritte müssen Sie zum benutzerdefinierten Benutzer wechseln (oder sich als Root abmelden und mit diesem anmelden).
+
 su <custom user>
+
Hinweis: Wenn Sie den Standardbenutzer und die Standardgruppe „cisys“ verwenden, müssen Sie diesen Schritt nicht ausführen.

+
Hinweis: Ein benutzerdefinierter Benutzer kann jeder Benutzer sein, der Mitglied einer benutzerdefinierten Gruppe ist, die Sie während der AU-Installation für cloudinsights-install.sh bereitgestellt haben. Er kann mit dem benutzerdefinierten Benutzer identisch sein, den Sie während der AU-Installation bereitgestellt haben, oder sich von diesem unterscheiden.

. Führen Sie die folgenden Schritte aus:
+
....
chmod 770 /var/lib/netapp/cloudinsights/acq/download/datasources-war-<version>.zip
ls -al /var/lib/netapp/cloudinsights/acq/download
…
drwxrwx--- 2 test-user2 test-group-1  4096 Feb 16 10:10 datasources-war-<version>.zip
…
....
+
Hinweis: Wenn Sie den Benutzer und die Gruppe „cisys“ verwenden, werden diese in der obigen Ausgabe angezeigt.

+
Hinweis: Wenn Sie die Installation mit verschiedenen benutzerdefinierten Benutzern planen, stellen Sie sicher, dass die Gruppenberechtigungen sowohl für den Eigentümer als auch für die Gruppe auf Lesen und Schreiben eingestellt sind (chmod 660 …).

. Starten Sie die AU neu. Navigieren Sie in Data Infrastructure Insights zu Observability > Collectors und wählen Sie die Registerkarte Acquisition Units aus.  Wählen Sie „Neustart“ aus dem Menü mit den drei Punkten rechts neben der AU.




== Herunterladen eines Patches

Laden Sie den Patch mit der API /collector/patch/file/{version} herunter:

image:API_Manual_Download_patch.png["API zum Abrufen des Patches"]

Hinweis: Bestätigen Sie mit NetApp die für den Download anzugebende Version.

Klicken Sie auf Datei herunterladen.  Wenn Sie diese Schritte auf einem anderen System als dem AU-System ausführen, kopieren Sie das heruntergeladene Patch-Zip-Paket auf das AU-System.

Stellen Sie sicher, dass das Patch-ZIP-Paket in das folgende Verzeichnis kopiert wird: /var/lib/netapp/cloudinsights/acq/download

Navigieren Sie zum Verzeichnis /var/lib/netapp/cloudinsights/acq/download für den Patch und überprüfen Sie dort die ZIP-Datei:

. Für die nächsten Schritte müssen Sie zum benutzerdefinierten Benutzer wechseln (oder sich als Root abmelden und mit diesem anmelden).
+
 su <custom user>
+
Hinweis: Wenn Sie den Standardbenutzer und die Standardgruppe „cisys“ verwenden, müssen Sie diesen Schritt nicht ausführen.

+
Hinweis: Ein benutzerdefinierter Benutzer kann jeder Benutzer sein, der Mitglied einer benutzerdefinierten Gruppe ist, die Sie während der AU-Installation für cloudinsights-install.sh bereitgestellt haben. Er kann mit dem benutzerdefinierten Benutzer identisch sein, den Sie während der AU-Installation bereitgestellt haben, oder sich von diesem unterscheiden.

. Führen Sie die folgenden Schritte aus:
+
....
chmod 770 /var/lib/netapp/cloudinsights/acq/download/<patch_file_name>.zip
ls -al /var/lib/netapp/cloudinsights/acq/download
…
drwxrwx--- 2 test-user2 test-group-1  4096 Feb 16 10:10 <patch_file_name>.zip
…
....
+
Hinweis: Wenn Sie den Benutzer und die Gruppe „cisys“ verwenden, werden diese in der obigen Ausgabe angezeigt.

+
Hinweis: Wenn Sie die Installation mit verschiedenen benutzerdefinierten Benutzern planen, stellen Sie sicher, dass die Gruppenberechtigungen sowohl für den Eigentümer als auch für die Gruppe auf Lesen und Schreiben eingestellt sind (chmod 660 …).

. Starten Sie die AU neu. Navigieren Sie in Data Infrastructure Insights zu Observability > Collectors und wählen Sie die Registerkarte Acquisition Units aus.  Wählen Sie „Neustart“ aus dem Menü mit den drei Punkten rechts neben der AU.




== Externer Schlüsselabruf

Wenn Sie ein UNIX-Shell-Skript bereitstellen, kann es von der Erfassungseinheit ausgeführt werden, um den *privaten Schlüssel* und den *öffentlichen Schlüssel* aus Ihrem Schlüsselverwaltungssystem abzurufen.

Um den Schlüssel abzurufen, führt Data Infrastructure Insights das Skript aus und übergibt zwei Parameter: _Schlüssel-ID_ und _Schlüsseltyp_.  Mit der _Schlüssel-ID_ können Sie den Schlüssel in Ihrem Schlüsselverwaltungssystem identifizieren.  _Schlüsseltyp_ ist entweder „öffentlich“ oder „privat“.  Wenn der Schlüsseltyp „öffentlich“ ist, muss das Skript den öffentlichen Schlüssel zurückgeben.  Wenn der Schlüsseltyp „privat“ ist, muss der private Schlüssel zurückgegeben werden.

Um den Schlüssel an die Erfassungseinheit zurückzusenden, muss das Skript den Schlüssel in der Standardausgabe drucken.  Das Skript darf _nur_ den Schlüssel in die Standardausgabe drucken. Es darf kein anderer Text in die Standardausgabe gedruckt werden.  Sobald der angeforderte Schlüssel in der Standardausgabe gedruckt wird, muss das Skript mit einem Exitcode von 0 beendet werden; jeder andere Rückgabecode wird als Fehler betrachtet.

Das Skript muss mithilfe des SecurityAdmin-Tools bei der Erfassungseinheit registriert werden, das das Skript zusammen mit der Erfassungseinheit ausführt.  Das Skript muss über Lese- und Ausführungsberechtigungen für den Root- und „cisys“-Benutzer verfügen.  Wenn das Shell-Skript nach der Registrierung geändert wird, muss das geänderte Shell-Skript erneut bei der Erfassungseinheit registriert werden.

|===


| Eingabeparameter: Schlüssel-ID | Schlüsselkennung, die zur Identifizierung des Schlüssels im Schlüsselverwaltungssystem des Kunden verwendet wird. 


| Eingabeparameter: Schlüsseltyp | öffentlich oder privat. 


| Ausgabe | Der angeforderte Schlüssel muss auf der Standardausgabe ausgegeben werden.  Derzeit wird ein 2048-Bit-RSA-Schlüssel unterstützt.  Schlüssel müssen im folgenden Format codiert und gedruckt werden: Privates Schlüsselformat – PEM, DER-codiert PKCS8 PrivateKeyInfo RFC 5958 Öffentliches Schlüsselformat – PEM, DER-codiert X.509 SubjectPublicKeyInfo RFC 5280 


| Exitcode | Bei Erfolg ist der Exitcode Null.  Alle anderen Exit-Werte gelten als Fehlschlag. 


| Skriptberechtigungen | Das Skript muss über Lese- und Ausführungsberechtigungen für den Root- und „cisys“-Benutzer verfügen. 


| Protokolle | Skriptausführungen werden protokolliert.  Protokolle finden Sie unter - /var/log/netapp/cloudinsights/securityadmin/securityadmin.log /var/log/netapp/cloudinsights/acq/acq.log 
|===