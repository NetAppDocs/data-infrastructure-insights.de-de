---
sidebar: sidebar 
permalink: task_config_telegraf_haproxy.html 
keywords: telegraf, installation, install, haproxy 
summary: HAProxy-Datensammlerkonfiguration 
---
= HAProxy-Datensammler
:hardbreaks:
:allow-uri-read: 


[role="lead"]
Data Infrastructure Insights verwendet diesen Datensammler, um Metriken von HAProxy zu sammeln.



== Installation

. Klicken Sie unter *Observability > Collectors* auf *+Data Collector*.  Wählen Sie HAProxy.
+
Wählen Sie das Betriebssystem oder die Plattform aus, auf der der Telegraf-Agent installiert ist.

. Wenn Sie noch keinen Agenten für die Sammlung installiert haben oder einen Agenten für ein anderes Betriebssystem oder eine andere Plattform installieren möchten, klicken Sie auf _Anweisungen anzeigen_, um daslink:task_config_telegraf_agent.html["Agenteninstallation"] Anweisungen.
. Wählen Sie den Agent-Zugriffsschlüssel zur Verwendung mit diesem Datensammler aus.  Sie können einen neuen Agentenzugriffsschlüssel hinzufügen, indem Sie auf die Schaltfläche *+ Agentenzugriffsschlüssel* klicken.  Best Practice: Verwenden Sie nur dann einen anderen Agent-Zugriffsschlüssel, wenn Sie Datensammler beispielsweise nach Betriebssystem/Plattform gruppieren möchten.
. Befolgen Sie die Konfigurationsschritte, um den Datensammler zu konfigurieren.  Die Anweisungen variieren je nach Art des Betriebssystems oder der Plattform, die Sie zum Sammeln von Daten verwenden.


image:HAProxyDCConfigLinux.png["HAProxy-Konfiguration"]



== Aufstellen

Das Plugin von Telegraf für HAProxy basiert auf der Aktivierung von HAProxy Stats.  Dies ist eine in HAProxy integrierte Konfiguration, die jedoch nicht standardmäßig aktiviert ist.  Wenn aktiviert, stellt HAProxy einen HTML-Endpunkt bereit, der in Ihrem Browser angezeigt oder zum Extrahieren des Status aller HAProxy-Konfigurationen abgerufen werden kann.



=== Kompatibilität:

Die Konfiguration wurde für HAProxy Version 1.9.4 entwickelt.



=== Einrichten:

Um Statistiken zu aktivieren, bearbeiten Sie Ihre Haproxy-Konfigurationsdatei und fügen Sie nach dem Abschnitt „Standardeinstellungen“ die folgenden Zeilen hinzu. Verwenden Sie dabei Ihren eigenen Benutzer/Ihr eigenes Passwort und/oder Ihre Haproxy-URL:

[listing]
----
stats enable
stats auth myuser:mypassword
stats uri  /haproxy?stats
----
Nachfolgend sehen Sie eine vereinfachte Beispielkonfigurationsdatei mit aktivierten Statistiken:

[listing]
----
global
  daemon
  maxconn 256

defaults
  mode http
  stats enable
  stats uri /haproxy?stats
  stats auth myuser:mypassword
  timeout connect 5000ms
  timeout client 50000ms
  timeout server 50000ms

frontend http-in
  bind *:80
  default_backend servers

frontend http-in9080
  bind *:9080
  default_backend servers_2

backend servers
  server server1 10.128.0.55:8080 check ssl verify none
  server server2 10.128.0.56:8080 check ssl verify none

backend servers_2
  server server3 10.128.0.57:8080 check ssl verify none
  server server4 10.128.0.58:8080 check ssl verify none
----
Vollständige und aktuelle Anweisungen finden Sie imlink:https://cbonte.github.io/haproxy-dconv/1.8/configuration.html#4-stats%20enable["HAProxy-Dokumentation"] .



== Objekte und Zähler

Die folgenden Objekte und ihre Zähler werden gesammelt:

[cols="<.<,<.<,<.<,<.<"]
|===
| Objekt: | Kennungen: | Merkmale: | Datenpunkte: 


| HAProxy Frontend | Namespace-Adressproxy | Knoten-IP Knotenname Proxy-ID Modus Prozess-ID Sitzungsratenbegrenzung Server-ID Sitzungsbegrenzungsstatus | Bytes Eingehend Bytes Ausgehend Cache-Treffer Cache-Suchen Komprimierung Bytes Umgangene Komprimierung Bytes Eingehend Komprimierung Bytes Ausgehend Komprimierung Antworten Verbindungsrate Verbindungsrate Max. Verbindungen Gesamt Durch Verbindungsregel abgelehnte Anfragen Durch Sicherheitsbedenken abgelehnte Anfragen Antworten Durch Sicherheitsbedenken abgelehnte Anfragen Durch Sitzungsregel abgelehnte Anfragen Fehler bei Anfragen Antworten 1xx Antworten 2xx Antworten 3xx Antworten 4xx Antworten 5xx Antworten Andere Anfragen Abgefangene Anfragen Sitzungsrate Sitzungsrate Max. Anfragen Rate Anfragen Rate Max. Anfragen Gesamtanzahl Sitzungen Sitzungen Max. Sitzungen Gesamtanzahl Anfragen Neuschreibungen 


| HAProxy Server | Namespace-Adress-Proxy-Server | Knoten-IP Knotenname Zeit bis zum Abschluss der Prüfung Fallkonfiguration prüfen Gesundheitswert prüfen Anstiegskonfiguration prüfen Status prüfen Proxy-ID Zeit der letzten Änderung Zeit der letzten Sitzung Modus Prozess-ID Server-ID Status Gewicht | Aktive Server Backup-Server Bytes rein Bytes raus Check-Downs Check-Fehlschläge Client-Abbrüche Verbindungen Durchschnittliche Verbindungsdauer Ausfallzeit Gesamt abgelehnte Antworten Verbindungsfehler Antwortfehler Antworten 1xx Antworten 2xx Antworten 3xx Antworten 4xx Antworten 5xx Antworten Andere ausgewählte Server Gesamtwarteschlange Aktuelle Warteschlange Max. Durchschnittliche Warteschlangendauer Sitzungen pro Sekunde Sitzungen pro Sekunde Max. Verbindungswiederverwendung Antwortzeit Durchschnittliche Sitzungen Sitzungen Max. Server-Übertragungsabbrüche Sitzungen Gesamtsitzungen Gesamtzeit Durchschnittliche Anfragen Neuzuweisungen Anfragen Wiederholungsversuche Anfragen Neuschreibungen 


| HAProxy-Backend | Namespace-Adressproxy | Knoten-IP Knotenname Proxy-ID Letzte Änderung Zeit der letzten Sitzung Modus Prozess-ID Server-ID Sitzungslimit Status Gewicht | Aktive Server Backup-Server Bytes In Bytes Out Cache-Treffer Cache-Lookups Check-Downs Client-Abbrüche Komprimierung Bytes Umgangene Komprimierung Bytes In Komprimierung Bytes Out Komprimierung Antworten Verbindungen Durchschnittliche Verbindungsausfallzeit Anfragen insgesamt aufgrund von Sicherheitsbedenken abgelehnt Antworten aufgrund von Sicherheitsbedenken abgelehnt Verbindungsfehler Antwortfehler Antworten 1xx Antworten 2xx Antworten 3xx Antworten 4xx Antworten 5xx Antworten Andere ausgewählte Server Gesamtwarteschlange Aktuelle Warteschlange Max. Durchschnittliche Warteschlangenzeit Sitzungen pro Sekunde Sitzungen pro Sekunde Max. Anfragen Gesamte Verbindungswiederverwendung Antwortzeit Durchschnittliche Sitzungen Sitzungen Max. Serverübertragungsabbrüche Sitzungen Gesamtsitzungen Gesamtzeit Durchschnittliche Anfragen Neuzuweisungen Anfragen Wiederholungsversuche Anfragen Neuschreibungen 
|===


== Fehlerbehebung

Weitere Informationen finden Sie in derlink:concept_requesting_support.html["Support"] Seite.
